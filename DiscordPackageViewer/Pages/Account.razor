@page "/account"
@inject PackageLoaderService Loader
@inject NavigationManager Nav
@inject ToastService Toast

<PageTitle>Account â€” Discord Package Viewer</PageTitle>

<div class="content-header">ðŸ‘¤ Account</div>
<div class="content-body">
    @if (Loader.Data?.UserProfile is { } profile)
    {
        <ProfileCard Profile="profile"
                     AvatarBytes="Loader.Data!.AvatarBytes"
                     AvatarMimeType="Loader.Data.AvatarMimeType" />

        <ChipCloud Items="@profile.Flags.Select(f => f.Replace("_", " ")).ToList()"
                   Title="Account Flags" />

        <ConnectionsTable Connections="profile.Connections" />
        <RelationshipsTable Relationships="profile.Relationships" />
        <SessionsTable Sessions="profile.UserSessions" />
        <GameActivityTable Stats="profile.UserActivityApplicationStatistics" />
    }
    else if (Loader.IsLoaded)
    {
        <p class="text-muted">No account data loaded.</p>
    }
</div>

@code {
    protected override void OnInitialized()
    {
        if (!Loader.IsLoaded)
        {
            Toast.Show("Please load a package first.", ToastLevel.Warning);
            Nav.NavigateTo("/");
        }
    }
}
